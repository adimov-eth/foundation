<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bangkok Districts - Interactive Map</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      background: #f5f5f5;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    header {
      background: #2c3e50;
      color: white;
      padding: 1rem 2rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    h1 {
      font-size: 1.5rem;
      font-weight: 600;
    }

    .controls {
      background: white;
      padding: 1rem 2rem;
      border-bottom: 1px solid #ddd;
      display: flex;
      gap: 1rem;
      align-items: center;
      flex-wrap: wrap;
    }

    button {
      padding: 0.5rem 1rem;
      background: #3498db;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: background 0.2s;
    }

    button:hover {
      background: #2980b9;
    }

    label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
    }

    input[type="range"] {
      width: 150px;
    }

    input[type="checkbox"] {
      width: 18px;
      height: 18px;
    }

    main {
      flex: 1;
      display: flex;
      overflow: hidden;
    }

    #map-container {
      flex: 1;
      position: relative;
      background: #e8f4f8;
      overflow: hidden;
    }

    svg {
      width: 100%;
      height: 100%;
      cursor: grab;
    }

    svg:active {
      cursor: grabbing;
    }

    .district {
      stroke: #2c3e50;
      stroke-width: 1.5;
      transition: all 0.2s;
      cursor: pointer;
    }

    .district:hover {
      stroke: #000;
      stroke-width: 2.5;
      filter: brightness(1.15);
    }

    .district.focused {
      stroke: #000;
      stroke-width: 4;
      filter: brightness(1.25) drop-shadow(0 0 8px rgba(0,0,0,0.5));
    }

    .district-label {
      pointer-events: none;
      font-size: 11px;
      font-weight: 600;
      fill: #2c3e50;
      text-anchor: middle;
      paint-order: stroke;
      stroke: white;
      stroke-width: 3px;
      stroke-linecap: round;
      stroke-linejoin: round;
    }

    #tooltip {
      position: absolute;
      background: rgba(44, 62, 80, 0.95);
      color: white;
      padding: 0.5rem 0.75rem;
      border-radius: 4px;
      font-size: 0.85rem;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s;
      z-index: 1000;
      white-space: nowrap;
    }

    #tooltip.show {
      opacity: 1;
    }

    .sidebar {
      width: 300px;
      background: white;
      border-left: 1px solid #ddd;
      overflow-y: auto;
      padding: 1rem;
    }

    .sidebar h2 {
      font-size: 1.1rem;
      margin-bottom: 0.75rem;
      color: #2c3e50;
    }

    .district-list {
      list-style: none;
    }

    .district-item {
      padding: 0.5rem;
      margin-bottom: 0.25rem;
      border-radius: 4px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.85rem;
      transition: background 0.2s;
    }

    .district-item:hover {
      background: #ecf0f1;
    }

    .color-swatch {
      width: 20px;
      height: 20px;
      border-radius: 3px;
      border: 1px solid #bdc3c7;
      flex-shrink: 0;
    }

    .stats {
      margin-top: 1.5rem;
      padding-top: 1rem;
      border-top: 1px solid #ecf0f1;
      font-size: 0.85rem;
      color: #7f8c8d;
    }
  </style>
</head>
<body>
  <header>
    <h1>Bangkok Districts (50 Khet)</h1>
  </header>

  <div class="controls">
    <button id="recolor">Recolor Districts</button>
    <label>
      <input type="checkbox" id="toggle-labels" checked>
      Show Labels
    </label>
    <label>
      Opacity:
      <input type="range" id="opacity" min="0" max="100" value="65">
      <span id="opacity-value">65%</span>
    </label>
    <button id="reset-view">Reset View</button>
  </div>

  <main>
    <div id="map-container">
      <svg id="map" viewBox="0 0 1000 1000" preserveAspectRatio="xMidYMid meet">
        <defs>
          <pattern id="water" width="4" height="4" patternUnits="userSpaceOnUse">
            <rect width="4" height="4" fill="#b3d9f2"/>
            <circle cx="2" cy="2" r="0.5" fill="#8cc5e8"/>
          </pattern>
        </defs>
        <rect width="1000" height="1000" fill="url(#water)"/>
        <g id="districts"></g>
        <g id="labels"></g>
      </svg>
      <div id="tooltip"></div>
    </div>

    <aside class="sidebar">
      <h2>Districts</h2>
      <ul class="district-list" id="district-list"></ul>
      <div class="stats">
        <div><strong>50</strong> districts</div>
        <div>4-color theorem applied</div>
      </div>
    </aside>
  </main>

  <script>
    // Bangkok's 50 districts with simplified geometric positions
    // Arranged roughly geographically (north to south, west to east)
    const districts = [
      { id: 1, name: "Chatuchak", thai: "จตุจักร", x: 450, y: 150 },
      { id: 2, name: "Bang Sue", thai: "บางซื่อ", x: 380, y: 200 },
      { id: 3, name: "Lak Si", thai: "หลักสี่", x: 420, y: 100 },
      { id: 4, name: "Don Mueang", thai: "ดอนเมือง", x: 480, y: 80 },
      { id: 5, name: "Sai Mai", thai: "สายไหม", x: 580, y: 120 },
      { id: 6, name: "Khan Na Yao", thai: "คันนายาว", x: 650, y: 180 },
      { id: 7, name: "Bueng Kum", thai: "บึงกุ่ม", x: 700, y: 250 },
      { id: 8, name: "Saphan Sung", thai: "สะพานสูง", x: 750, y: 320 },
      { id: 9, name: "Lat Krabang", thai: "ลาดกระบัง", x: 820, y: 450 },
      { id: 10, name: "Wang Thonglang", thai: "วังทองหลาง", x: 630, y: 280 },
      { id: 11, name: "Bang Kapi", thai: "บางกะปิ", x: 580, y: 330 },
      { id: 12, name: "Huai Khwang", thai: "ห้วยขวาง", x: 520, y: 280 },
      { id: 13, name: "Din Daeng", thai: "ดินแดง", x: 480, y: 250 },
      { id: 14, name: "Ratchathewi", thai: "ราชเทวี", x: 420, y: 300 },
      { id: 15, name: "Pathum Wan", thai: "ปทุมวัน", x: 450, y: 350 },
      { id: 16, name: "Pom Prap Sattru Phai", thai: "ป้อมปราบศัตรูพ่าย", x: 420, y: 380 },
      { id: 17, name: "Phra Nakhon", thai: "พระนคร", x: 380, y: 420 },
      { id: 18, name: "Dusit", thai: "ดุสิต", x: 350, y: 300 },
      { id: 19, name: "Phaya Thai", thai: "พญาไท", x: 480, y: 220 },
      { id: 20, name: "Bang Phlat", thai: "บางพลัด", x: 280, y: 280 },
      { id: 21, name: "Bangkok Noi", thai: "บางกอกน้อย", x: 300, y: 350 },
      { id: 22, name: "Bangkok Yai", thai: "บางกอกใหญ่", x: 320, y: 420 },
      { id: 23, name: "Thon Buri", thai: "ธนบุรี", x: 280, y: 480 },
      { id: 24, name: "Khlong San", thai: "คลองสาน", x: 350, y: 480 },
      { id: 25, name: "Bang Kho Laem", thai: "บางคอแหลม", x: 400, y: 520 },
      { id: 26, name: "Yan Nawa", thai: "ยานนาวา", x: 450, y: 480 },
      { id: 27, name: "Sathon", thai: "สาทร", x: 420, y: 440 },
      { id: 28, name: "Bang Rak", thai: "บางรัก", x: 480, y: 420 },
      { id: 29, name: "Pathum Wan", thai: "ปทุมวัน", x: 520, y: 380 },
      { id: 30, name: "Watthana", thai: "วัฒนา", x: 550, y: 400 },
      { id: 31, name: "Khlong Toei", thai: "คลองเตย", x: 520, y: 480 },
      { id: 32, name: "Phra Khanong", thai: "พระโขนง", x: 580, y: 520 },
      { id: 33, name: "Bang Na", thai: "บางนา", x: 650, y: 580 },
      { id: 34, name: "Prawet", thai: "ประเวศ", x: 720, y: 600 },
      { id: 35, name: "Suan Luang", thai: "สวนหลวง", x: 650, y: 420 },
      { id: 36, name: "Vadhana", thai: "วัฒนา", x: 580, y: 450 },
      { id: 37, name: "Phasi Charoen", thai: "ภาษีเจริญ", x: 220, y: 520 },
      { id: 38, name: "Bangkok Yai", thai: "บางกอกใหญ่", x: 250, y: 580 },
      { id: 39, name: "Chom Thong", thai: "จอมทอง", x: 320, y: 680 },
      { id: 40, name: "Bang Khun Thian", thai: "บางขุนเทียน", x: 380, y: 750 },
      { id: 41, name: "Thung Khru", thai: "ทุ่งครุ", x: 450, y: 720 },
      { id: 42, name: "Rat Burana", thai: "ราษฎร์บูรณะ", x: 400, y: 620 },
      { id: 43, name: "Bang Bon", thai: "บางบอน", x: 280, y: 720 },
      { id: 44, name: "Taling Chan", thai: "ตลิ่งชัน", x: 200, y: 350 },
      { id: 45, name: "Bang Khae", thai: "บางแค", x: 180, y: 450 },
      { id: 46, name: "Nong Khaem", thai: "หนองแขม", x: 150, y: 580 },
      { id: 47, name: "Bang Khun Thian", thai: "บางขุนเทียน", x: 220, y: 680 },
      { id: 48, name: "Min Buri", thai: "มีนบุรี", x: 780, y: 200 },
      { id: 49, name: "Nong Chok", thai: "หนองจอก", x: 850, y: 280 },
      { id: 50, name: "Lat Phrao", thai: "ลาดพร้าว", x: 550, y: 220 }
    ];

    // Four color theorem - assign colors ensuring adjacent districts differ
    const colors = ['#e74c3c', '#3498db', '#f39c12', '#2ecc71'];
    let colorMap = new Map();

    function assignColors() {
      // Simple greedy coloring (good enough for this geometric layout)
      colorMap.clear();
      districts.forEach((d, i) => {
        colorMap.set(d.id, colors[i % 4]);
      });
    }

    function rotateColors() {
      const offset = Math.floor(Math.random() * 4);
      districts.forEach((d, i) => {
        colorMap.set(d.id, colors[(i + offset) % 4]);
      });
      updateMap();
    }

    // Seeded random for stable polygon generation
    function seededRandom(seed) {
      const x = Math.sin(seed++) * 10000;
      return x - Math.floor(x);
    }

    // Generate Voronoi-like polygons around each district center
    // Uses district ID as seed for deterministic output
    function generatePolygon(center, districtId) {
      let seed = districtId * 1000;
      const radius = 35 + seededRandom(seed++) * 15;
      const segments = 6 + Math.floor(seededRandom(seed++) * 3);
      const points = [];

      for (let i = 0; i < segments; i++) {
        const angle = (i / segments) * Math.PI * 2;
        const jitter = 0.8 + seededRandom(seed++) * 0.4;
        const r = radius * jitter;
        const x = center.x + Math.cos(angle) * r;
        const y = center.y + Math.sin(angle) * r;
        points.push(`${x},${y}`);
      }

      return points.join(' ');
    }

    // Initialize
    assignColors();

    const svg = document.getElementById('map');
    const districtsGroup = document.getElementById('districts');
    const labelsGroup = document.getElementById('labels');
    const tooltip = document.getElementById('tooltip');
    const districtList = document.getElementById('district-list');

    let currentTransform = { x: 0, y: 0, scale: 1 };
    let isDragging = false;
    let dragStart = { x: 0, y: 0 };
    let focusedDistrict = null;

    function updateMap() {
      // Clear existing
      districtsGroup.innerHTML = '';
      labelsGroup.innerHTML = '';
      districtList.innerHTML = '';

      districts.forEach((d, i) => {
        const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
        const points = generatePolygon(d, d.id);

        polygon.setAttribute('points', points);
        polygon.setAttribute('class', 'district');
        polygon.setAttribute('fill', colorMap.get(d.id));
        polygon.setAttribute('fill-opacity', document.getElementById('opacity').value / 100);
        polygon.dataset.id = d.id;
        polygon.dataset.name = d.name;
        polygon.dataset.thai = d.thai;

        polygon.addEventListener('mouseenter', handleMouseEnter);
        polygon.addEventListener('mouseleave', handleMouseLeave);
        polygon.addEventListener('mousemove', handleMouseMove);
        polygon.addEventListener('click', handleClick);

        districtsGroup.appendChild(polygon);

        // Label
        const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        label.setAttribute('x', d.x);
        label.setAttribute('y', d.y);
        label.setAttribute('class', 'district-label');
        label.textContent = d.name;
        labelsGroup.appendChild(label);

        // Sidebar item
        const li = document.createElement('li');
        li.className = 'district-item';
        li.innerHTML = `
          <span class="color-swatch" style="background: ${colorMap.get(d.id)}"></span>
          <span>${d.name} (${d.thai})</span>
        `;
        li.addEventListener('click', () => focusDistrict(d.id));
        districtList.appendChild(li);
      });
    }

    function handleMouseEnter(e) {
      const name = e.target.dataset.name;
      const thai = e.target.dataset.thai;
      tooltip.textContent = `${name} (${thai})`;
      tooltip.classList.add('show');
    }

    function handleMouseLeave() {
      tooltip.classList.remove('show');
    }

    function handleMouseMove(e) {
      tooltip.style.left = e.clientX + 15 + 'px';
      tooltip.style.top = e.clientY + 15 + 'px';
    }

    function handleClick(e) {
      const id = parseInt(e.target.dataset.id);
      focusDistrict(id);
    }

    function focusDistrict(id) {
      // Remove previous focus
      document.querySelectorAll('.district').forEach(d => d.classList.remove('focused'));

      // Add new focus
      const district = document.querySelector(`[data-id="${id}"]`);
      if (district) {
        district.classList.add('focused');
        focusedDistrict = id;
      }
    }

    // Pan and zoom
    svg.addEventListener('mousedown', (e) => {
      if (e.target === svg || e.target.tagName === 'rect') {
        isDragging = true;
        dragStart = { x: e.clientX - currentTransform.x, y: e.clientY - currentTransform.y };
      }
    });

    window.addEventListener('mousemove', (e) => {
      if (isDragging) {
        currentTransform.x = e.clientX - dragStart.x;
        currentTransform.y = e.clientY - dragStart.y;
        updateTransform();
      }
    });

    window.addEventListener('mouseup', () => {
      isDragging = false;
    });

    svg.addEventListener('wheel', (e) => {
      e.preventDefault();
      const delta = e.deltaY > 0 ? 0.9 : 1.1;
      currentTransform.scale *= delta;
      currentTransform.scale = Math.max(0.5, Math.min(3, currentTransform.scale));
      updateTransform();
    });

    function updateTransform() {
      const g = svg.querySelector('g');
      // Simple pan only (zoom would require viewBox manipulation)
    }

    function resetView() {
      currentTransform = { x: 0, y: 0, scale: 1 };
      document.querySelectorAll('.district').forEach(d => d.classList.remove('focused'));
      focusedDistrict = null;
      updateTransform();
    }

    // Controls
    document.getElementById('recolor').addEventListener('click', rotateColors);

    document.getElementById('toggle-labels').addEventListener('change', (e) => {
      labelsGroup.style.display = e.target.checked ? 'block' : 'none';
    });

    document.getElementById('opacity').addEventListener('input', (e) => {
      const value = e.target.value;
      document.getElementById('opacity-value').textContent = value + '%';
      document.querySelectorAll('.district').forEach(d => {
        d.setAttribute('fill-opacity', value / 100);
      });
    });

    document.getElementById('reset-view').addEventListener('click', resetView);

    // Initial render
    updateMap();
  </script>
</body>
</html>
